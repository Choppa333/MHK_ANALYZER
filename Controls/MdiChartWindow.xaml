<UserControl x:Class="MGK_Analyzer.Controls.MdiChartWindow"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
             mc:Ignorable="d" 
             Width="800" Height="600"
             FontFamily="Malgun Gothic">

    <UserControl.Resources>
        <DropShadowEffect x:Key="WindowShadow" ShadowDepth="3" BlurRadius="10" Opacity="0.3"/>

        <!-- Panel Slide Animations -->
        <Storyboard x:Key="PanelSlideInStoryboard">
            <DoubleAnimation Storyboard.TargetName="ManagementPanel"
                           Storyboard.TargetProperty="Width"
                           From="0" To="250" Duration="0:0:0.2">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>
        <Storyboard x:Key="PanelSlideOutStoryboard">
            <DoubleAnimation Storyboard.TargetName="ManagementPanel"
                           Storyboard.TargetProperty="Width"
                           From="250" To="0" Duration="0:0:0.15">
                <DoubleAnimation.EasingFunction>
                    <CubicEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
        </Storyboard>

    </UserControl.Resources>

    <Border Background="White" BorderBrush="Gray" BorderThickness="1"
            CornerRadius="5" Effect="{StaticResource WindowShadow}">

        <!-- Context Menu for Right-click resize options -->
        <Border.ContextMenu>
            <ContextMenu FontFamily="Malgun Gothic">
                <MenuItem Header="Size Settings" FontWeight="Bold" IsEnabled="False"/>
                <Separator/>
                <MenuItem Header="Small (400 x 300)" Click="SetSmallSize_Click"/>
                <MenuItem Header="Medium (800 x 600)" Click="SetMediumSize_Click"/>
                <MenuItem Header="Large (1200 x 800)" Click="SetLargeSize_Click"/>
                <MenuItem Header="HD (Max)" Click="SetHDSize_Click"/>
                <Separator/>
                <MenuItem Header="Custom..." Click="ShowCustomSizeDialog_Click"/>
                <Separator/>
                <MenuItem Header="Maximize" Click="Maximize_Click"/>
                <MenuItem Header="Minimize" Click="Minimize_Click"/>
            </ContextMenu>
        </Border.ContextMenu>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="30"/>
                <RowDefinition Height="279*"/>
                <RowDefinition Height="5*"/>
            </Grid.RowDefinitions>

            <!-- Title Bar -->
            <Border Grid.Row="0" Background="SteelBlue" CornerRadius="5,5,0,0"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">
                <Grid>
                    <TextBlock Text="{Binding WindowTitle, RelativeSource={RelativeSource AncestorType=UserControl}}"
                              Foreground="White" VerticalAlignment="Center" Margin="10,0"
                              FontWeight="SemiBold" FontFamily="Malgun Gothic"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="5">
                        <Button Content="-" Width="25" Height="20" Click="Minimize_Click"
                                Background="Transparent" BorderBrush="White" Foreground="White"
                                Margin="1" FontFamily="Malgun Gothic"/>
                        <Button Content="Max" Width="25" Height="20" Click="Maximize_Click"
                                Background="Transparent" BorderBrush="White" Foreground="White"
                                Margin="1" FontFamily="Malgun Gothic"/>
                        <Button Content="X" Width="25" Height="20" Click="Close_Click"
                                Background="Transparent" BorderBrush="White" Foreground="White"
                                Margin="1" FontFamily="Malgun Gothic"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Content Area -->
            <Grid Grid.Row="1" Grid.RowSpan="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition x:Name="LeftPanelColumn"
                                      Width="320"
                                      MinWidth="0"
                                      MaxWidth="600"/>
                    <ColumnDefinition x:Name="LeftPanelSplitterColumn" Width="5"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Snapshot/Data Table Panel Container -->
                <Border Grid.Column="0" x:Name="LeftPanelContainer" ClipToBounds="True">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <!-- Collapsed Tab Button (Left) -->
                        <Border Grid.Column="0" x:Name="LeftPanelTab" Width="12" MinWidth="10"
                                Background="#FF2D2D30"
                                BorderBrush="#FF3E3E42" BorderThickness="0,0,1,0"
                                Cursor="Hand" Visibility="Collapsed"
                                MouseEnter="LeftPanelTab_MouseEnter"
                                MouseDown="LeftPanelTab_MouseDown">
                            <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                                <TextBlock Text="S" FontSize="10" Foreground="White" FontWeight="Bold"
                                           HorizontalAlignment="Center" Margin="1" FontFamily="Malgun Gothic"/>
                                <TextBlock Text="N" FontSize="8" Foreground="#FFAAAAAA"
                                           HorizontalAlignment="Center" Margin="0,1" FontFamily="Malgun Gothic"/>
                                <TextBlock Text="A" FontSize="8" Foreground="#FFAAAAAA"
                                           HorizontalAlignment="Center" Margin="0,1" FontFamily="Malgun Gothic"/>
                                <TextBlock Text="P" FontSize="8" Foreground="#FFAAAAAA"
                                           HorizontalAlignment="Center" Margin="0,1" FontFamily="Malgun Gothic"/>
                            </StackPanel>
                        </Border>

                        <!-- Left Panel -->
                        <Border Grid.Column="1" x:Name="LeftPanel"
                                MinWidth="220" Background="WhiteSmoke"
                                BorderBrush="LightGray" BorderThickness="0,0,1,0"
                                MouseLeave="LeftPanel_MouseLeave">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Panel Header -->
                                <Border Grid.Row="0" Background="#FFE8E8E8"
                                        BorderBrush="#FFCCCCCC" BorderThickness="0,0,0,1"
                                        Height="30">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0" Text="Snapshots"
                                                   FontSize="12" FontWeight="SemiBold"
                                                   VerticalAlignment="Center" Margin="8,0"
                                                   FontFamily="Malgun Gothic"/>
                                        <ToggleButton Grid.Column="1" x:Name="LeftPanelPinButton"
                                                      Width="24" Height="20" Margin="5"
                                                      Checked="LeftPanelPinButton_Checked"
                                                      Unchecked="LeftPanelPinButton_Unchecked"
                                                      ToolTip="Pin/Unpin">
                                            <TextBlock Text="PIN" FontSize="8"/>
                                        </ToggleButton>
                                    </Grid>
                                </Border>

                                <!-- Panel Content -->
                                <TabControl x:Name="LeftPanelTabs" Grid.Row="1" Background="Transparent"
                                           BorderThickness="0" Margin="5"
                                           SelectionChanged="LeftPanelTabs_SelectionChanged">
                                    <TabItem Header="Snapshot" FontFamily="Malgun Gothic" FontSize="11">
                                        <Grid Margin="0,5,0,0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>

                                            <TextBlock Grid.Row="0" Text="Add a cursor to capture a snapshot."
                                                       FontSize="10" Foreground="Gray" Margin="5"
                                                       HorizontalAlignment="Center">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding SnapshotList.Count, RelativeSource={RelativeSource AncestorType=UserControl}}" Value="0">
                                                                <Setter Property="Visibility" Value="Visible"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>

                                            <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                                <ItemsControl ItemsSource="{Binding SnapshotList, RelativeSource={RelativeSource AncestorType=UserControl}}">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Border Background="White"
                                                                    BorderBrush="#FFDDDDDD"
                                                                    BorderThickness="1"
                                                                    CornerRadius="3"
                                                                    Padding="10"
                                                                    Margin="5">
                                                                <StackPanel>
                                                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                                                        <Rectangle Width="14" Height="14" Fill="{Binding CursorBrush}" RadiusX="2" RadiusY="2"/>
                                                                        <TextBlock Text="{Binding CursorLabel}"
                                                                                   FontWeight="SemiBold"
                                                                                   FontSize="12" Margin="6,0,0,0"/>
                                                                    </StackPanel>
                                                                    <TextBlock Text="{Binding CursorTimeDisplay}"
                                                                               FontSize="10" Foreground="Gray"/>
                                                                    <Separator Margin="0,6"/>
                                                                    <ItemsControl ItemsSource="{Binding SeriesValues}">
                                                                        <ItemsControl.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <Grid Margin="0,2">
                                                                                    <Grid.ColumnDefinitions>
                                                                                        <ColumnDefinition Width="*"/>
                                                                                        <ColumnDefinition Width="Auto"/>
                                                                                        <ColumnDefinition Width="Auto"/>
                                                                                    </Grid.ColumnDefinitions>
                                                                                    <TextBlock Grid.Column="0"
                                                                                               Text="{Binding SeriesName}"
                                                                                               FontSize="11"/>
                                                                                    <TextBlock Grid.Column="1"
                                                                                               Text="{Binding ValueText}"
                                                                                               FontWeight="SemiBold"
                                                                                               Margin="10,0,0,0"
                                                                                               HorizontalAlignment="Right"/>
                                                                                    <TextBlock Grid.Column="2"
                                                                                               Text="{Binding Unit}"
                                                                                               Margin="5,0,0,0"
                                                                                               Foreground="Gray"
                                                                                               FontSize="10"/>
                                                                                </Grid>
                                                                            </DataTemplate>
                                                                        </ItemsControl.ItemTemplate>
                                                                    </ItemsControl>
                                                                </StackPanel>
                                                            </Border>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </ScrollViewer>
                                        </Grid>
                                    </TabItem>
                                    <TabItem Header="Data Table" FontFamily="Malgun Gothic" FontSize="11">
                                        <Grid Margin="0,5,0,0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="*"/>
                                            </Grid.RowDefinitions>

                                            <Grid Grid.Row="0" Margin="5,0,5,5">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*" />
                                                    <ColumnDefinition Width="Auto" />
                                                    <ColumnDefinition Width="Auto" />
                                                </Grid.ColumnDefinitions>

                                                <Border Grid.Column="0"
                                                        Background="#FFF6F6F6"
                                                        BorderBrush="#FFDDDDDD"
                                                        BorderThickness="1"
                                                        CornerRadius="3"
                                                        Padding="6"
                                                        Margin="0,0,5,0">
                                                    <TextBlock Text="{Binding DataTableStatus, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                               FontWeight="SemiBold"
                                                               FontSize="11"
                                                               Foreground="#FF444444"/>
                                                </Border>

                                                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,5,0">
                                                    <Button Content="Prev" Padding="10,4" MinWidth="50" Click="PreviousPage_Click"/>
                                                    <Button Content="Next" Padding="10,4" MinWidth="50" Margin="4,0,0,0" Click="NextPage_Click"/>
                                                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center" Margin="10,0,0,0">
                                                        <TextBlock Text="Page" VerticalAlignment="Center" FontSize="11"/>
                                                        <TextBox x:Name="PageNumberTextBox" Width="40" Height="22" Margin="4,0,0,0" VerticalContentAlignment="Center"/>
                                                        <TextBlock Text="/" VerticalAlignment="Center" FontSize="11" Margin="4,0,0,0"/>
                                                        <TextBlock Text="{Binding TotalPageCount, RelativeSource={RelativeSource AncestorType=UserControl}}" VerticalAlignment="Center" FontSize="11" Margin="2,0,0,0"/>
                                                        <Button Content="Go" Padding="8,2" Margin="6,0,0,0" Click="GoToPage_Click"/>
                                                    </StackPanel>
                                                </StackPanel>

                                                <Button Grid.Column="2"
                                                        Content="Export to Excel"
                                                        Padding="12,4"
                                                        Margin="0,0,0,0"
                                                        FontSize="11"
                                                        Click="ExportDataTable_Click"
                                                        ToolTip="Save the current data table to an Excel file."/>
                                            </Grid>

                                            <Grid Grid.Row="1">
                                                <syncfusion:SfDataGrid x:Name="DataTableGrid"
                                                                       ItemsSource="{Binding DataTableView, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                                       AutoGenerateColumns="True"
                                                                       AllowFiltering="True"
                                                                       AllowSorting="True"
                                                                       AllowResizingColumns="True"
                                                                       SelectionUnit="Row"
                                                                       NavigationMode="Row"
                                                                       ColumnSizer="Auto"
                                                                       IsReadOnly="True"
                                                                       FontFamily="Malgun Gothic"
                                                                       FontSize="11"
                                                                       Margin="5"
                                                                       EnableDataVirtualization="True">
                                                    <syncfusion:SfDataGrid.Style>
                                                        <Style TargetType="syncfusion:SfDataGrid">
                                                            <Setter Property="Visibility" Value="Visible"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding DataTableView, RelativeSource={RelativeSource AncestorType=UserControl}}" Value="{x:Null}">
                                                                    <Setter Property="Visibility" Value="Collapsed"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </syncfusion:SfDataGrid.Style>
                                                </syncfusion:SfDataGrid>

                                                <TextBlock Text="No data available."
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"
                                                           Foreground="Gray"
                                                           FontStyle="Italic">
                                                    <TextBlock.Style>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding DataTableView, RelativeSource={RelativeSource AncestorType=UserControl}}" Value="{x:Null}">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </TextBlock.Style>
                                                </TextBlock>
                                            </Grid>
                                        </Grid>
                                    </TabItem>
                                </TabControl>
                            </Grid>
                        </Border>
                    </Grid>
                </Border>

                <!-- Resizable Separator -->
                <GridSplitter Grid.Column="1"
                              Width="5"
                              Background="#FFDDDDDD"
                              HorizontalAlignment="Stretch"
                              VerticalAlignment="Stretch"
                              ShowsPreview="True"
                              ResizeBehavior="PreviousAndNext"
                              ResizeDirection="Columns"
                              IsTabStop="False"
                              DragCompleted="LeftPanelSplitter_DragCompleted"/>

                <!-- Syncfusion Chart (with cursor overlay) -->
                <Grid Grid.Column="2">
                    <Grid Margin="5">
                        <Grid>
                            <syncfusion:SfChart x:Name="ChartControl" 
                                               Panel.ZIndex="0"
                                               FontFamily="Malgun Gothic">
                            <syncfusion:SfChart.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Save as Image" Click="SaveChartAsImage_Click"/>
                                </ContextMenu>
                            </syncfusion:SfChart.ContextMenu>
                            <syncfusion:SfChart.PrimaryAxis>
                                <syncfusion:DateTimeAxis Header="Time" 
                                                        LabelFormat="HH:mm:ss"
                                                        FontFamily="Malgun Gothic"
                                                        FontSize="11"/>
                            </syncfusion:SfChart.PrimaryAxis>
                            <syncfusion:SfChart.SecondaryAxis>
                                <syncfusion:NumericalAxis Header="Value"
                                                         FontFamily="Malgun Gothic"
                                                         FontSize="11"/>
                            </syncfusion:SfChart.SecondaryAxis>
                            <syncfusion:SfChart.Legend>
                                <syncfusion:ChartLegend DockPosition="Right" 
                                                       FontFamily="Malgun Gothic"
                                                       FontSize="10"/>
                            </syncfusion:SfChart.Legend>
                            </syncfusion:SfChart>

                            <Canvas x:Name="CursorOverlay"
                                    Panel.ZIndex="10"
                                    IsHitTestVisible="False"
                                    Width="{Binding ActualWidth, ElementName=ChartControl}"
                                    Height="{Binding ActualHeight, ElementName=ChartControl}"/>
                        </Grid>
                    </Grid>
                </Grid>

                <!-- Management Panel Container -->
                <Border Grid.Column="3" x:Name="ManagementPanelContainer" ClipToBounds="True">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="25"/>
                        </Grid.ColumnDefinitions>

                        <!-- Management Panel -->
                        <Border Grid.Column="0" x:Name="ManagementPanel"
                                Width="250" Background="WhiteSmoke" 
                                BorderBrush="LightGray" BorderThickness="1,0,0,0"
                                MouseLeave="ManagementPanel_MouseLeave">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <!-- Panel Header -->
                                <Border Grid.Row="0" Background="#FFE8E8E8" 
                                        BorderBrush="#FFCCCCCC" BorderThickness="0,0,0,1"
                                        Height="30">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBlock Grid.Column="0" Text="Data Management" 
                                                   FontSize="12" FontWeight="SemiBold"
                                                   VerticalAlignment="Center" Margin="8,0"
                                                   FontFamily="Malgun Gothic"/>

                                        <!-- Pin Button -->
                                        <ToggleButton Grid.Column="1" x:Name="PanelPinButton"
                                                      Width="24" Height="20" Margin="5"
                                                      Checked="PanelPinButton_Checked"
                                                      Unchecked="PanelPinButton_Unchecked"
                                                      ToolTip="Pin/Unpin">
                                            <TextBlock Text="PIN" FontSize="8"/>
                                        </ToggleButton>
                                    </Grid>
                                </Border>

                                <!-- Panel Content -->
                                <TabControl x:Name="ManagementPanelTabs" Grid.Row="1" Background="Transparent" 
                                           BorderThickness="0" Margin="5"
                                           SelectionChanged="ManagementPanelTabs_SelectionChanged">
                                    <!-- Series Tab -->
                                    <TabItem Header="Series" FontFamily="Malgun Gothic" FontSize="11">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                                            <ItemsControl ItemsSource="{Binding SeriesList, RelativeSource={RelativeSource AncestorType=UserControl}}">
                                                <ItemsControl.ItemTemplate>
                                                    <DataTemplate>
                                                        <Border Background="White" 
                                                               BorderBrush="#FFDDDDDD" 
                                                               BorderThickness="1" 
                                                               CornerRadius="3"
                                                               Margin="2" Padding="5">
                                                            <Grid>
                                                                <Grid.ColumnDefinitions>
                                                                    <ColumnDefinition Width="Auto"/>
                                                                    <ColumnDefinition Width="*"/>
                                                                </Grid.ColumnDefinitions>

                                                                <CheckBox Grid.Column="0"
                                                                          IsChecked="{Binding IsSelected}"
                                                                          VerticalAlignment="Center"
                                                                          Margin="0,0,8,0"/>

                                                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                                    <TextBlock Text="{Binding SeriesData.Name}" 
                                                                               FontWeight="SemiBold" FontSize="11"
                                                                               FontFamily="Malgun Gothic"/>
                                                                    <TextBlock Text="{Binding SeriesData.Unit}" 
                                                                               FontSize="10" Foreground="Gray"
                                                                               FontFamily="Malgun Gothic"/>
                                                                </StackPanel>
                                                            </Grid>
                                                        </Border>
                                                    </DataTemplate>
                                                </ItemsControl.ItemTemplate>
                                            </ItemsControl>
                                        </ScrollViewer>
                                    </TabItem>

                                    <!-- Properties Tab -->
                                    <TabItem Header="Properties" FontFamily="Malgun Gothic" FontSize="11">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                                            <StackPanel Margin="5">
                                                <TextBlock Text="Chart Properties" FontWeight="Bold" 
                                                          FontFamily="Malgun Gothic" Margin="0,0,0,10"/>

                                                <TextBlock Text="Metadata" FontWeight="Bold"
                                                          FontFamily="Malgun Gothic" Margin="0,0,0,5"/>
                                                <Grid Margin="0,0,0,10">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Type:" FontSize="10"
                                                               VerticalAlignment="Center" Margin="0,0,6,4"/>
                                                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding MetaTypeDisplay, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                               FontSize="10" Margin="0,0,0,4"/>

                                                    <TextBlock Grid.Row="1" Grid.Column="0" Text="Date:" FontSize="10"
                                                               VerticalAlignment="Center" Margin="0,0,6,0"/>
                                                    <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding MetaDateDisplay, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                               FontSize="10"/>
                                                </Grid>

                                                <TextBlock Text="Title:" FontSize="10" 
                                                          FontFamily="Malgun Gothic" Margin="0,5,0,2"/>
                                                <TextBox Text="{Binding WindowTitle, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                                        FontFamily="Malgun Gothic" Padding="3"/>

                                                <!-- Chart Size Settings -->
                                                <TextBlock Text="Chart Size" FontWeight="Bold" 
                                                          FontFamily="Malgun Gothic" Margin="0,15,0,5"/>

                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>

                                                    <TextBlock Grid.Row="0" Grid.Column="0" Text="Width:" FontSize="10" 
                                                              VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                    <TextBox Grid.Row="0" Grid.Column="1" x:Name="WidthTextBox"
                                                            Text="{Binding ActualWidth, RelativeSource={RelativeSource AncestorType=UserControl}, StringFormat=F0, Mode=OneWay}"
                                                            FontFamily="Malgun Gothic" Padding="3" Margin="0,0,10,5"/>

                                                    <TextBlock Grid.Row="0" Grid.Column="2" Text="Height:" FontSize="10" 
                                                              VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                    <TextBox Grid.Row="0" Grid.Column="3" x:Name="HeightTextBox"
                                                            Text="{Binding ActualHeight, RelativeSource={RelativeSource AncestorType=UserControl}, StringFormat=F0, Mode=OneWay}"
                                                            FontFamily="Malgun Gothic" Padding="3" Margin="0,0,0,5"/>

                                                    <Button Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" 
                                                           Content="Apply Size" Click="ApplySize_Click"
                                                           FontFamily="Malgun Gothic" Padding="5" Margin="0,5"/>

                                                    <Button Grid.Row="1" Grid.Column="2" Grid.ColumnSpan="2" 
                                                           Content="Reset Size" Click="ResetSize_Click"
                                                           FontFamily="Malgun Gothic" Padding="5" Margin="0,5"/>
                                                </Grid>

                                                <!-- Preset Size Buttons -->
                                                <TextBlock Text="Preset Sizes" FontWeight="Bold" 
                                                          FontFamily="Malgun Gothic" Margin="0,10,0,5"/>
                                                <StackPanel Orientation="Horizontal" Margin="0,5">
                                                    <Button Content="Small (400x300)" Click="SetSmallSize_Click"
                                                           FontFamily="Malgun Gothic" Padding="5" Margin="0,0,5,0" FontSize="9"/>
                                                    <Button Content="Medium (800x600)" Click="SetMediumSize_Click"
                                                           FontFamily="Malgun Gothic" Padding="5" Margin="0,0,5,0" FontSize="9"/>
                                                </StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="0,5">
                                                    <Button Content="Large (1200x800)" Click="SetLargeSize_Click"
                                                           FontFamily="Malgun Gothic" Padding="5" Margin="0,0,5,0" FontSize="9"/>
                                                    <Button Content="HD (1920x1080)" Click="SetHDSize_Click"
                                                           FontFamily="Malgun Gothic" Padding="5" Margin="0,0,5,0" FontSize="9"/>
                                                </StackPanel>

                                                <TextBlock Text="Additional Properties" FontWeight="Bold" 
                                                          FontFamily="Malgun Gothic" Margin="0,15,0,5"/>
                                                <TextBlock Text="Position, Zoom, Export options..." FontSize="10" 
                                                          Foreground="Gray" FontFamily="Malgun Gothic"/>
                                            </StackPanel>
                                        </ScrollViewer>
                                    </TabItem>

                                    <!-- Cursor Tab -->
                                    <TabItem Header="Cursor" FontFamily="Malgun Gothic" FontSize="11">
                                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                                            <StackPanel Margin="5">
                                                <TextBlock Text="Cursor Management" FontWeight="Bold" 
                                                          FontFamily="Malgun Gothic" Margin="0,0,0,10"/>

                                                <Button Content="Add Cursor" Padding="5" 
                                                       FontFamily="Malgun Gothic" Margin="0,5" Click="AddCursor_Click"/>
                                                <Button Content="Remove Cursor" Padding="5" 
                                                       FontFamily="Malgun Gothic" Margin="0,5" Click="RemoveCursor_Click"/>

                                                <TextBlock Text="(To be implemented)" FontSize="10" 
                                                          Foreground="Gray" FontFamily="Malgun Gothic" Margin="0,10"/>
                                            </StackPanel>
                                        </ScrollViewer>
                                    </TabItem>
                                </TabControl>
                            </Grid>
                        </Border>

                        <!-- Collapsed Tab Button -->
                        <Border Grid.Column="1" x:Name="ManagementPanelTab"
                                Background="#FF2D2D30" 
                                BorderBrush="#FF3E3E42" BorderThickness="1,0,0,0"
                                Cursor="Hand" Visibility="Collapsed"
                                MouseEnter="ManagementPanelTab_MouseEnter"
                                MouseDown="ManagementPanelTab_MouseDown">
                            <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                                <TextBlock Text="D" FontSize="10" Foreground="White" FontWeight="Bold"
                                           HorizontalAlignment="Center" Margin="1" FontFamily="Malgun Gothic"/>
                                <TextBlock Text="A" FontSize="8" Foreground="#FFAAAAAA" 
                                           HorizontalAlignment="Center" Margin="0,1" FontFamily="Malgun Gothic"/>
                                <TextBlock Text="T" FontSize="8" Foreground="#FFAAAAAA" 
                                           HorizontalAlignment="Center" Margin="0,1" FontFamily="Malgun Gothic"/>
                                <TextBlock Text="A" FontSize="8" Foreground="#FFAAAAAA" 
                                           HorizontalAlignment="Center" Margin="0,1" FontFamily="Malgun Gothic"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>
            </Grid>

            <!-- Resize Handles - All directions resizable -->
            <!-- Top Edge -->
            <Rectangle Height="5" Fill="Transparent" VerticalAlignment="Top"
                      Cursor="SizeNS" MouseLeftButtonDown="ResizeTop_MouseLeftButtonDown"
                      Margin="5,0,5,0" ToolTip="Drag top edge to resize height" Panel.ZIndex="1000"/>

            <!-- Bottom Edge -->
            <Rectangle Height="6" Fill="Transparent" VerticalAlignment="Center"
                      Cursor="SizeNS" MouseLeftButtonDown="ResizeBottom_MouseLeftButtonDown"
                      Margin="5,0,5,0" ToolTip="Drag bottom edge to resize height" Panel.ZIndex="1000" Grid.Row="2"/>

            <!-- Left Edge -->
            <Rectangle Width="5" Fill="Transparent" 
                      HorizontalAlignment="Left"
                      Cursor="SizeWE" MouseLeftButtonDown="ResizeLeft_MouseLeftButtonDown"
                      Margin="0,5,0,5" ToolTip="Drag left edge to resize width"
                      Grid.RowSpan="3" Panel.ZIndex="1000"/>

            <!-- Right Edge -->
            <Rectangle Width="5" Fill="Transparent" 
                      HorizontalAlignment="Right"
                      Cursor="SizeWE" MouseLeftButtonDown="ResizeRight_MouseLeftButtonDown"
                      Margin="0,5,0,5" ToolTip="Drag right edge to resize width"
                      Grid.RowSpan="3" Panel.ZIndex="1000"/>

            <!-- Corner Handles -->
            <!-- Top-Left Corner -->
            <Rectangle Width="10" Height="10" Fill="DarkGray" 
                      HorizontalAlignment="Left" VerticalAlignment="Top"
                      Cursor="SizeNWSE" MouseLeftButtonDown="ResizeTopLeft_MouseLeftButtonDown"
                      Margin="0,0,0,0" ToolTip="Drag corner to resize" Panel.ZIndex="1000"/>

            <!-- Top-Right Corner -->
            <Rectangle Width="10" Height="10" Fill="DarkGray" 
                      HorizontalAlignment="Right" VerticalAlignment="Top"
                      Cursor="SizeNESW" MouseLeftButtonDown="ResizeTopRight_MouseLeftButtonDown"
                      Margin="0,0,0,0" ToolTip="Drag corner to resize" Panel.ZIndex="1000"/>

            <!-- Bottom-Left Corner -->
            <Rectangle Width="10" Height="10" Fill="DarkGray" 
                      HorizontalAlignment="Left" VerticalAlignment="Center"
                      Cursor="SizeNESW" MouseLeftButtonDown="ResizeBottomLeft_MouseLeftButtonDown" ToolTip="Drag corner to resize" Panel.ZIndex="1000" Grid.Row="2"/>

            <!-- Bottom-Right Corner -->
            <Rectangle Width="15" Height="15" Fill="Gray" 
                      HorizontalAlignment="Right" VerticalAlignment="Bottom"
                      Cursor="SizeNWSE" MouseLeftButtonDown="ResizeBottomRight_MouseLeftButtonDown"
                      Margin="0,0,0,0" ToolTip="Drag corner to resize"
                      Grid.RowSpan="2" Panel.ZIndex="1000" Grid.Row="1"/>

            <!-- Removed visual corner indicator paths for cleaner UI -->
        </Grid>
    </Border>
</UserControl>
