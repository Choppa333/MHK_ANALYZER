<Window x:Class="MGK_Analyzer.Windows.EfficiencySurface3DWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:syncfusion="clr-namespace:Syncfusion.UI.Xaml.Charts;assembly=Syncfusion.SfChart.WPF"
        Title="3D Efficiency Surface" Height="720" Width="1180">
  <DockPanel>

    <!-- Toolbar for surface controls -->
    <ToolBarTray DockPanel.Dock="Top">
      <ToolBar>
        <TextBlock Text="Tilt" Margin="0,0,6,0" VerticalAlignment="Center"/>
        <Slider x:Name="SldTilt" Width="120" Minimum="-60" Maximum="60" Value="15" TickFrequency="5" IsSnapToTickEnabled="True"/>
        <TextBlock Text="Rotate" Margin="10,0,6,0" VerticalAlignment="Center"/>
        <Slider x:Name="SldRotate" Width="140" Minimum="-180" Maximum="180" Value="30" TickFrequency="10" IsSnapToTickEnabled="True"/>

        <Separator/>

        <TextBlock Text="Levels" Margin="10,0,6,0" VerticalAlignment="Center"/>
        <Slider x:Name="SldLevels" Width="110" Minimum="5" Maximum="32" Value="16" TickFrequency="1" IsSnapToTickEnabled="True"/>
        <TextBlock Text="Opacity" Margin="10,0,6,0" VerticalAlignment="Center"/>
        <Slider x:Name="SldOpacity" Width="110" Minimum="0.2" Maximum="1.0" Value="1.0" TickFrequency="0.1"/>

        <Separator/>

        <TextBlock Text="Palette" Margin="10,0,6,0" VerticalAlignment="Center"/>
        <ComboBox x:Name="CmbPalette" Width="180" SelectedIndex="0">
          <ComboBoxItem Content="Metro"/>
          <ComboBoxItem Content="BlueChrome"/>
          <ComboBoxItem Content="GreenChrome"/>
          <ComboBoxItem Content="Custom (Blue-Yellow-Red)"/>
        </ComboBox>

        <Separator/>
        <Button x:Name="BtnResetView" Content="Reset View" Margin="10,0,0,0" Padding="8,2"/>
      </ToolBar>
    </ToolBarTray>

    <Grid>
      <Grid.ColumnDefinitions>
        <ColumnDefinition/>
        <ColumnDefinition Width="120"/>
      </Grid.ColumnDefinitions>

      <!-- SURFACE3D: Configure per Syncfusion docs - WITHOUT ColorBar to avoid Y-based coloring -->
      <syncfusion:SfSurfaceChart x:Name="SurfaceChart"
                                 Grid.Column="0"
                                 Type="Surface"
                                 Tilt="15" Rotate="30"
                                 FontSize="12"
                                 Header="3D Efficiency Map (X=Speed, Y=Efficiency, Z=Torque)">
        <syncfusion:SfSurfaceChart.XAxis>
          <syncfusion:SurfaceAxis Header="[X] Speed [rpm]" LabelFormat="#####"/>
        </syncfusion:SfSurfaceChart.XAxis>
        <syncfusion:SfSurfaceChart.YAxis>
          <syncfusion:SurfaceAxis Header="[Y] Efficiency [%]" LabelFormat="0.0"/>
        </syncfusion:SfSurfaceChart.YAxis>
        <syncfusion:SfSurfaceChart.ZAxis>
          <syncfusion:SurfaceAxis Header="[Z] Torque [Nm]" LabelFormat="0.#"/>
        </syncfusion:SfSurfaceChart.ZAxis>

        <!-- NO ColorBar - we use custom legend instead -->
      </syncfusion:SfSurfaceChart>

      <!-- Custom Z-based legend (display-only, no interference with chart) -->
      <Border Grid.Column="1" Margin="6" Padding="6" Background="White" BorderBrush="#DDD" BorderThickness="1">
        <StackPanel Orientation="Vertical">
          <TextBlock Text="[Y] Efficiency [%]" FontWeight="Bold" Margin="0,0,0,6" Foreground="#333" FontSize="12"/>
          <ItemsControl x:Name="ZLegend" >
            <ItemsControl.ItemTemplate>
              <DataTemplate>
                <StackPanel Orientation="Horizontal" Margin="0,3">
                  <Rectangle Width="16" Height="16" Fill="{Binding Fill}" Stroke="#888" StrokeThickness="0.5"/>
                  <TextBlock Text="{Binding Label}" Margin="8,0,0,0" VerticalAlignment="Center" FontSize="11"/>
                </StackPanel>
              </DataTemplate>
            </ItemsControl.ItemTemplate>
          </ItemsControl>
        </StackPanel>
      </Border>
    </Grid>
  </DockPanel>
</Window>
